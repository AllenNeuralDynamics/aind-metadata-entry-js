"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports["default"] = void 0;

var _IconButton = _interopRequireDefault(require("../IconButton"));

var _react = _interopRequireDefault(require("react"));

var _propTypes = _interopRequireDefault(require("prop-types"));

var types = _interopRequireWildcard(require("../../types"));

var _utils = require("../../utils");

function _interopRequireWildcard(obj) { if (obj && obj.__esModule) { return obj; } else { var newObj = {}; if (obj != null) { for (var key in obj) { if (Object.prototype.hasOwnProperty.call(obj, key)) { var desc = Object.defineProperty && Object.getOwnPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : {}; if (desc.get || desc.set) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } } newObj["default"] = obj; return newObj; } }

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { "default": obj }; }

function _typeof(obj) { if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError("Cannot call a class as a function"); } }

function _defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if ("value" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } }

function _createClass(Constructor, protoProps, staticProps) { if (protoProps) _defineProperties(Constructor.prototype, protoProps); if (staticProps) _defineProperties(Constructor, staticProps); return Constructor; }

function _possibleConstructorReturn(self, call) { if (call && (_typeof(call) === "object" || typeof call === "function")) { return call; } return _assertThisInitialized(self); }

function _assertThisInitialized(self) { if (self === void 0) { throw new ReferenceError("this hasn't been initialised - super() hasn't been called"); } return self; }

function _getPrototypeOf(o) { _getPrototypeOf = Object.setPrototypeOf ? Object.getPrototypeOf : function _getPrototypeOf(o) { return o.__proto__ || Object.getPrototypeOf(o); }; return _getPrototypeOf(o); }

function _inherits(subClass, superClass) { if (typeof superClass !== "function" && superClass !== null) { throw new TypeError("Super expression must either be null or a function"); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, writable: true, configurable: true } }); if (superClass) _setPrototypeOf(subClass, superClass); }

function _setPrototypeOf(o, p) { _setPrototypeOf = Object.setPrototypeOf || function _setPrototypeOf(o, p) { o.__proto__ = p; return o; }; return _setPrototypeOf(o, p); }

function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }

function _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; var ownKeys = Object.keys(source); if (typeof Object.getOwnPropertySymbols === 'function') { ownKeys = ownKeys.concat(Object.getOwnPropertySymbols(source).filter(function (sym) { return Object.getOwnPropertyDescriptor(source, sym).enumerable; })); } ownKeys.forEach(function (key) { _defineProperty(target, key, source[key]); }); } return target; }

function _defineProperty(obj, key, value) { if (key in obj) { Object.defineProperty(obj, key, { value: value, enumerable: true, configurable: true, writable: true }); } else { obj[key] = value; } return obj; }

function _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }

function _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }

var REQUIRED_FIELD_SYMBOL = "*";
var COMPONENT_TYPES = {
  array: "ArrayField",
  "boolean": "BooleanField",
  integer: "NumberField",
  number: "NumberField",
  object: "ObjectField",
  string: "StringField",
  "null": "NullField"
};

function getFieldComponent(schema, uiSchema, idSchema, fields) {
  var field = uiSchema["ui:field"];

  if (typeof field === "function") {
    return field;
  }

  if (typeof field === "string" && field in fields) {
    return fields[field];
  }

  var componentName = COMPONENT_TYPES[(0, _utils.getSchemaType)(schema)]; // If the type is not defined and the schema uses 'anyOf' or 'oneOf', don't
  // render a field and let the MultiSchemaField component handle the form display

  if (!componentName && (schema.anyOf || schema.oneOf)) {
    return function () {
      return null;
    };
  }

  return componentName in fields ? fields[componentName] : function () {
    var UnsupportedField = fields.UnsupportedField;
    return (
      /*#__PURE__*/
      _react["default"].createElement(UnsupportedField, {
        schema: schema,
        idSchema: idSchema,
        reason: "Unknown field type ".concat(schema.type)
      })
    );
  };
}

function Label(props) {
  var label = props.label,
      required = props.required,
      id = props.id;

  if (!label) {
    return null;
  }

  return (
    /*#__PURE__*/
    _react["default"].createElement("label", {
      className: "control-label",
      htmlFor: id
    }, label, required &&
    /*#__PURE__*/
    _react["default"].createElement("span", {
      className: "required"
    }, REQUIRED_FIELD_SYMBOL))
  );
}

function LabelInput(props) {
  var id = props.id,
      label = props.label,
      onChange = props.onChange;
  return (
    /*#__PURE__*/
    _react["default"].createElement("input", {
      className: "form-control",
      type: "text",
      id: id,
      onBlur: function onBlur(event) {
        return onChange(event.target.value);
      },
      defaultValue: label
    })
  );
}

function Help(props) {
  var id = props.id,
      help = props.help;

  if (!help) {
    return null;
  }

  if (typeof help === "string") {
    return (
      /*#__PURE__*/
      _react["default"].createElement("p", {
        id: id,
        className: "help-block"
      }, help)
    );
  }

  return (
    /*#__PURE__*/
    _react["default"].createElement("div", {
      id: id,
      className: "help-block"
    }, help)
  );
}

function ErrorList(props) {
  var _props$errors = props.errors,
      errors = _props$errors === void 0 ? [] : _props$errors;

  if (errors.length === 0) {
    return null;
  }

  return (
    /*#__PURE__*/
    _react["default"].createElement("div", null,
    /*#__PURE__*/
    _react["default"].createElement("ul", {
      className: "error-detail bs-callout bs-callout-info"
    }, errors.filter(function (elem) {
      return !!elem;
    }).map(function (error, index) {
      return (
        /*#__PURE__*/
        _react["default"].createElement("li", {
          className: "text-danger",
          key: index
        }, error)
      );
    })))
  );
}

function DefaultTemplate(props) {
  var id = props.id,
      label = props.label,
      children = props.children,
      errors = props.errors,
      help = props.help,
      description = props.description,
      hidden = props.hidden,
      required = props.required,
      displayLabel = props.displayLabel;

  if (hidden) {
    return (
      /*#__PURE__*/
      _react["default"].createElement("div", {
        className: "hidden"
      }, children)
    );
  }

  return (
    /*#__PURE__*/
    _react["default"].createElement(WrapIfAdditional, props, displayLabel &&
    /*#__PURE__*/
    _react["default"].createElement(Label, {
      label: label,
      required: required,
      id: id
    }), displayLabel && description ? description : null, children, errors, help)
  );
}

if (process.env.NODE_ENV !== "production") {
  DefaultTemplate.propTypes = {
    id: _propTypes["default"].string,
    classNames: _propTypes["default"].string,
    label: _propTypes["default"].string,
    children: _propTypes["default"].node.isRequired,
    errors: _propTypes["default"].element,
    rawErrors: _propTypes["default"].arrayOf(_propTypes["default"].string),
    help: _propTypes["default"].element,
    rawHelp: _propTypes["default"].oneOfType([_propTypes["default"].string, _propTypes["default"].element]),
    description: _propTypes["default"].element,
    rawDescription: _propTypes["default"].oneOfType([_propTypes["default"].string, _propTypes["default"].element]),
    hidden: _propTypes["default"].bool,
    required: _propTypes["default"].bool,
    readonly: _propTypes["default"].bool,
    displayLabel: _propTypes["default"].bool,
    fields: _propTypes["default"].object,
    formContext: _propTypes["default"].object
  };
}

DefaultTemplate.defaultProps = {
  hidden: false,
  readonly: false,
  required: false,
  displayLabel: true
};

function WrapIfAdditional(props) {
  var id = props.id,
      classNames = props.classNames,
      disabled = props.disabled,
      label = props.label,
      onKeyChange = props.onKeyChange,
      onDropPropertyClick = props.onDropPropertyClick,
      readonly = props.readonly,
      required = props.required,
      schema = props.schema;
  var keyLabel = "".concat(label, " Key"); // i18n ?

  var additional = schema.hasOwnProperty(_utils.ADDITIONAL_PROPERTY_FLAG);

  if (!additional) {
    return (
      /*#__PURE__*/
      _react["default"].createElement("div", {
        className: classNames
      }, props.children)
    );
  }

  return (
    /*#__PURE__*/
    _react["default"].createElement("div", {
      className: classNames
    },
    /*#__PURE__*/
    _react["default"].createElement("div", {
      className: "row"
    },
    /*#__PURE__*/
    _react["default"].createElement("div", {
      className: "col-xs-5 form-additional"
    },
    /*#__PURE__*/
    _react["default"].createElement("div", {
      className: "form-group"
    },
    /*#__PURE__*/
    _react["default"].createElement(Label, {
      label: keyLabel,
      required: required,
      id: "".concat(id, "-key")
    }),
    /*#__PURE__*/
    _react["default"].createElement(LabelInput, {
      label: label,
      required: required,
      id: "".concat(id, "-key"),
      onChange: onKeyChange
    }))),
    /*#__PURE__*/
    _react["default"].createElement("div", {
      className: "form-additional form-group col-xs-5"
    }, props.children),
    /*#__PURE__*/
    _react["default"].createElement("div", {
      className: "col-xs-2"
    },
    /*#__PURE__*/
    _react["default"].createElement(_IconButton["default"], {
      type: "danger",
      icon: "remove",
      className: "array-item-remove btn-block",
      tabIndex: "-1",
      style: {
        border: "0"
      },
      disabled: disabled || readonly,
      onClick: onDropPropertyClick(label)
    }))))
  );
}

function SchemaFieldRender(props) {
  var uiSchema = props.uiSchema,
      formData = props.formData,
      errorSchema = props.errorSchema,
      idPrefix = props.idPrefix,
      idSeparator = props.idSeparator,
      name = props.name,
      onChange = props.onChange,
      onKeyChange = props.onKeyChange,
      onDropPropertyClick = props.onDropPropertyClick,
      required = props.required,
      registry = props.registry,
      _props$wasPropertyKey = props.wasPropertyKeyModified,
      wasPropertyKeyModified = _props$wasPropertyKey === void 0 ? false : _props$wasPropertyKey;
  var rootSchema = registry.rootSchema,
      fields = registry.fields,
      formContext = registry.formContext;
  var FieldTemplate = uiSchema["ui:FieldTemplate"] || registry.FieldTemplate || DefaultTemplate;
  var idSchema = props.idSchema;
  var schema = (0, _utils.retrieveSchema)(props.schema, rootSchema, formData);
  idSchema = (0, _utils.mergeObjects)((0, _utils.toIdSchema)(schema, null, rootSchema, formData, idPrefix, idSeparator), idSchema);
  var FieldComponent = getFieldComponent(schema, uiSchema, idSchema, fields);
  var DescriptionField = fields.DescriptionField;
  var disabled = Boolean(props.disabled || uiSchema["ui:disabled"]);
  var readonly = Boolean(props.readonly || uiSchema["ui:readonly"] || props.schema.readOnly || schema.readOnly);
  var uiSchemaHideError = uiSchema["ui:hideError"]; // Set hideError to the value provided in the uiSchema, otherwise stick with the prop to propagate to children

  var hideError = uiSchemaHideError === undefined ? props.hideError : Boolean(uiSchemaHideError);
  var autofocus = Boolean(props.autofocus || uiSchema["ui:autofocus"]);

  if (Object.keys(schema).length === 0) {
    return null;
  }

  var displayLabel = (0, _utils.getDisplayLabel)(schema, uiSchema, rootSchema);

  var __errors = errorSchema.__errors,
      fieldErrorSchema = _objectWithoutProperties(errorSchema, ["__errors"]); // See #439: uiSchema: Don't pass consumed class names to child components


  var field =
  /*#__PURE__*/
  _react["default"].createElement(FieldComponent, _extends({}, props, {
    idSchema: idSchema,
    schema: schema,
    uiSchema: _objectSpread({}, uiSchema, {
      classNames: undefined
    }),
    disabled: disabled,
    readonly: readonly,
    hideError: hideError,
    autofocus: autofocus,
    errorSchema: fieldErrorSchema,
    formContext: formContext,
    rawErrors: __errors
  }));

  var id = idSchema.$id; // If this schema has a title defined, but the user has set a new key/label, retain their input.

  var label;

  if (wasPropertyKeyModified) {
    label = name;
  } else {
    label = uiSchema["ui:title"] || props.schema.title || schema.title || name;
  }

  var description = uiSchema["ui:description"] || props.schema.description || schema.description;
  var errors = __errors;
  var help = uiSchema["ui:help"];
  var hidden = uiSchema["ui:widget"] === "hidden";
  var classNames = ["form-group", "field", "field-".concat(schema.type)];

  if (!hideError && errors && errors.length > 0) {
    classNames.push("field-error has-error has-danger");
  }

  classNames.push(uiSchema.classNames);
  classNames = classNames.join(" ").trim();
  var fieldProps = {
    description:
    /*#__PURE__*/
    _react["default"].createElement(DescriptionField, {
      id: id + "__description",
      description: description,
      formContext: formContext
    }),
    rawDescription: description,
    help:
    /*#__PURE__*/
    _react["default"].createElement(Help, {
      id: id + "__help",
      help: help
    }),
    rawHelp: typeof help === "string" ? help : undefined,
    errors: hideError ? undefined :
    /*#__PURE__*/
    _react["default"].createElement(ErrorList, {
      errors: errors
    }),
    rawErrors: hideError ? undefined : errors,
    id: id,
    label: label,
    hidden: hidden,
    onChange: onChange,
    onKeyChange: onKeyChange,
    onDropPropertyClick: onDropPropertyClick,
    required: required,
    disabled: disabled,
    readonly: readonly,
    hideError: hideError,
    displayLabel: displayLabel,
    classNames: classNames,
    formContext: formContext,
    formData: formData,
    fields: fields,
    schema: schema,
    uiSchema: uiSchema,
    registry: registry
  };
  var _AnyOfField = registry.fields.AnyOfField;
  var _OneOfField = registry.fields.OneOfField;
  return (
    /*#__PURE__*/
    _react["default"].createElement(FieldTemplate, fieldProps,
    /*#__PURE__*/
    _react["default"].createElement(_react["default"].Fragment, null, field, schema.anyOf && !(0, _utils.isSelect)(schema) &&
    /*#__PURE__*/
    _react["default"].createElement(_AnyOfField, {
      disabled: disabled,
      readonly: readonly,
      hideError: hideError,
      errorSchema: errorSchema,
      formData: formData,
      idPrefix: idPrefix,
      idSchema: idSchema,
      idSeparator: idSeparator,
      onBlur: props.onBlur,
      onChange: props.onChange,
      onFocus: props.onFocus,
      options: schema.anyOf.map(function (_schema) {
        return (0, _utils.retrieveSchema)(_schema, rootSchema, formData);
      }),
      baseType: schema.type,
      registry: registry,
      schema: schema,
      uiSchema: uiSchema
    }), schema.oneOf && !(0, _utils.isSelect)(schema) &&
    /*#__PURE__*/
    _react["default"].createElement(_OneOfField, {
      disabled: disabled,
      readonly: readonly,
      hideError: hideError,
      errorSchema: errorSchema,
      formData: formData,
      idPrefix: idPrefix,
      idSchema: idSchema,
      idSeparator: idSeparator,
      onBlur: props.onBlur,
      onChange: props.onChange,
      onFocus: props.onFocus,
      options: schema.oneOf.map(function (_schema) {
        return (0, _utils.retrieveSchema)(_schema, rootSchema, formData);
      }),
      baseType: schema.type,
      registry: registry,
      schema: schema,
      uiSchema: uiSchema
    })))
  );
}

var SchemaField =
/*#__PURE__*/
function (_React$Component) {
  _inherits(SchemaField, _React$Component);

  function SchemaField() {
    _classCallCheck(this, SchemaField);

    return _possibleConstructorReturn(this, _getPrototypeOf(SchemaField).apply(this, arguments));
  }

  _createClass(SchemaField, [{
    key: "shouldComponentUpdate",
    value: function shouldComponentUpdate(nextProps, nextState) {
      return !(0, _utils.deepEquals)(this.props, nextProps);
    }
  }, {
    key: "render",
    value: function render() {
      return SchemaFieldRender(this.props);
    }
  }]);

  return SchemaField;
}(_react["default"].Component);

SchemaField.defaultProps = {
  uiSchema: {},
  errorSchema: {},
  idSchema: {},
  disabled: false,
  readonly: false,
  autofocus: false,
  hideError: false
};

if (process.env.NODE_ENV !== "production") {
  SchemaField.propTypes = {
    schema: _propTypes["default"].object.isRequired,
    uiSchema: _propTypes["default"].object,
    idSchema: _propTypes["default"].object,
    formData: _propTypes["default"].any,
    errorSchema: _propTypes["default"].object,
    registry: types.registry.isRequired
  };
}

var _default = SchemaField;
exports["default"] = _default;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9jb21wb25lbnRzL2ZpZWxkcy9TY2hlbWFGaWVsZC5qcyJdLCJuYW1lcyI6WyJSRVFVSVJFRF9GSUVMRF9TWU1CT0wiLCJDT01QT05FTlRfVFlQRVMiLCJhcnJheSIsImludGVnZXIiLCJudW1iZXIiLCJvYmplY3QiLCJzdHJpbmciLCJnZXRGaWVsZENvbXBvbmVudCIsInNjaGVtYSIsInVpU2NoZW1hIiwiaWRTY2hlbWEiLCJmaWVsZHMiLCJmaWVsZCIsImNvbXBvbmVudE5hbWUiLCJhbnlPZiIsIm9uZU9mIiwiVW5zdXBwb3J0ZWRGaWVsZCIsInR5cGUiLCJMYWJlbCIsInByb3BzIiwibGFiZWwiLCJyZXF1aXJlZCIsImlkIiwiTGFiZWxJbnB1dCIsIm9uQ2hhbmdlIiwiZXZlbnQiLCJ0YXJnZXQiLCJ2YWx1ZSIsIkhlbHAiLCJoZWxwIiwiRXJyb3JMaXN0IiwiZXJyb3JzIiwibGVuZ3RoIiwiZmlsdGVyIiwiZWxlbSIsIm1hcCIsImVycm9yIiwiaW5kZXgiLCJEZWZhdWx0VGVtcGxhdGUiLCJjaGlsZHJlbiIsImRlc2NyaXB0aW9uIiwiaGlkZGVuIiwiZGlzcGxheUxhYmVsIiwicHJvY2VzcyIsImVudiIsIk5PREVfRU5WIiwicHJvcFR5cGVzIiwiUHJvcFR5cGVzIiwiY2xhc3NOYW1lcyIsIm5vZGUiLCJpc1JlcXVpcmVkIiwiZWxlbWVudCIsInJhd0Vycm9ycyIsImFycmF5T2YiLCJyYXdIZWxwIiwib25lT2ZUeXBlIiwicmF3RGVzY3JpcHRpb24iLCJib29sIiwicmVhZG9ubHkiLCJmb3JtQ29udGV4dCIsImRlZmF1bHRQcm9wcyIsIldyYXBJZkFkZGl0aW9uYWwiLCJkaXNhYmxlZCIsIm9uS2V5Q2hhbmdlIiwib25Ecm9wUHJvcGVydHlDbGljayIsImtleUxhYmVsIiwiYWRkaXRpb25hbCIsImhhc093blByb3BlcnR5IiwiQURESVRJT05BTF9QUk9QRVJUWV9GTEFHIiwiYm9yZGVyIiwiU2NoZW1hRmllbGRSZW5kZXIiLCJmb3JtRGF0YSIsImVycm9yU2NoZW1hIiwiaWRQcmVmaXgiLCJpZFNlcGFyYXRvciIsIm5hbWUiLCJyZWdpc3RyeSIsIndhc1Byb3BlcnR5S2V5TW9kaWZpZWQiLCJyb290U2NoZW1hIiwiRmllbGRUZW1wbGF0ZSIsIkZpZWxkQ29tcG9uZW50IiwiRGVzY3JpcHRpb25GaWVsZCIsIkJvb2xlYW4iLCJyZWFkT25seSIsInVpU2NoZW1hSGlkZUVycm9yIiwiaGlkZUVycm9yIiwidW5kZWZpbmVkIiwiYXV0b2ZvY3VzIiwiT2JqZWN0Iiwia2V5cyIsIl9fZXJyb3JzIiwiZmllbGRFcnJvclNjaGVtYSIsIiRpZCIsInRpdGxlIiwicHVzaCIsImpvaW4iLCJ0cmltIiwiZmllbGRQcm9wcyIsIl9BbnlPZkZpZWxkIiwiQW55T2ZGaWVsZCIsIl9PbmVPZkZpZWxkIiwiT25lT2ZGaWVsZCIsIm9uQmx1ciIsIm9uRm9jdXMiLCJfc2NoZW1hIiwiU2NoZW1hRmllbGQiLCJuZXh0UHJvcHMiLCJuZXh0U3RhdGUiLCJSZWFjdCIsIkNvbXBvbmVudCIsImFueSIsInR5cGVzIl0sIm1hcHBpbmdzIjoiOzs7Ozs7O0FBQUE7O0FBQ0E7O0FBQ0E7O0FBQ0E7O0FBRUE7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7QUFXQSxJQUFNQSxxQkFBcUIsR0FBRyxHQUE5QjtBQUNBLElBQU1DLGVBQWUsR0FBRztBQUN0QkMsRUFBQUEsS0FBSyxFQUFFLFlBRGU7QUFFdEIsYUFBUyxjQUZhO0FBR3RCQyxFQUFBQSxPQUFPLEVBQUUsYUFIYTtBQUl0QkMsRUFBQUEsTUFBTSxFQUFFLGFBSmM7QUFLdEJDLEVBQUFBLE1BQU0sRUFBRSxhQUxjO0FBTXRCQyxFQUFBQSxNQUFNLEVBQUUsYUFOYztBQU90QixVQUFNO0FBUGdCLENBQXhCOztBQVVBLFNBQVNDLGlCQUFULENBQTJCQyxNQUEzQixFQUFtQ0MsUUFBbkMsRUFBNkNDLFFBQTdDLEVBQXVEQyxNQUF2RCxFQUErRDtBQUM3RCxNQUFNQyxLQUFLLEdBQUdILFFBQVEs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LFlBQTdCLEVBQTJDO0FBQ3pDNEQsRUFBQUEsV0FBVyxDQUFDM0QsU0FBWixHQUF3QjtBQUN0QnRDLElBQUFBLE1BQU0sRUFBRXVDLHNCQUFVMUMsTUFBVixDQUFpQjZDLFVBREg7QUFFdEJ6QyxJQUFBQSxRQUFRLEVBQUVzQyxzQkFBVTFDLE1BRkU7QUFHdEJLLElBQUFBLFFBQVEsRUFBRXFDLHNCQUFVMUMsTUFIRTtBQUl0QmtFLElBQUFBLFFBQVEsRUFBRXhCLHNCQUFVK0QsR0FKRTtBQUt0QnRDLElBQUFBLFdBQVcsRUFBRXpCLHNCQUFVMUMsTUFMRDtBQU10QnVFLElBQUFBLFFBQVEsRUFBRW1DLEtBQUssQ0FBQ25DLFFBQU4sQ0FBZTFCO0FBTkgsR0FBeEI7QUFRRDs7ZUFFY3VELFciLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgSWNvbkJ1dHRvbiBmcm9tIFwiLi4vSWNvbkJ1dHRvblwiO1xuaW1wb3J0IFJlYWN0IGZyb20gXCJyZWFjdFwiO1xuaW1wb3J0IFByb3BUeXBlcyBmcm9tIFwicHJvcC10eXBlc1wiO1xuaW1wb3J0ICogYXMgdHlwZXMgZnJvbSBcIi4uLy4uL3R5cGVzXCI7XG5cbmltcG9ydCB7XG4gIEFERElUSU9OQUxfUFJPUEVSVFlfRkxBRyxcbiAgaXNTZWxlY3QsXG4gIHJldHJpZXZlU2NoZW1hLFxuICB0b0lkU2NoZW1hLFxuICBtZXJnZU9iamVjdHMsXG4gIGRlZXBFcXVhbHMsXG4gIGdldFNjaGVtYVR5cGUsXG4gIGdldERpc3BsYXlMYWJlbCxcbn0gZnJvbSBcIi4uLy4uL3V0aWxzXCI7XG5cbmNvbnN0IFJFUVVJUkVEX0ZJRUxEX1NZTUJPTCA9IFwiKlwiO1xuY29uc3QgQ09NUE9ORU5UX1RZUEVTID0ge1xuICBhcnJheTogXCJBcnJheUZpZWxkXCIsXG4gIGJvb2xlYW46IFwiQm9vbGVhbkZpZWxkXCIsXG4gIGludGVnZXI6IFwiTnVtYmVyRmllbGRcIixcbiAgbnVtYmVyOiBcIk51bWJlckZpZWxkXCIsXG4gIG9iamVjdDogXCJPYmplY3RGaWVsZFwiLFxuICBzdHJpbmc6IFwiU3RyaW5nRmllbGRcIixcbiAgbnVsbDogXCJOdWxsRmllbGRcIixcbn07XG5cbmZ1bmN0aW9uIGdldEZpZWxkQ29tcG9uZW50KHNjaGVtYSwgdWlTY2hlbWEsIGlkU2NoZW1hLCBmaWVsZHMpIHtcbiAgY29uc3QgZmllbGQgPSB1aVNjaGVtYVtcInVpOmZpZWxkXCJdO1xuICBpZiAodHlwZW9mIGZpZWxkID09PSBcImZ1bmN0aW9uXCIpIHtcbiAgICByZXR1cm4gZmllbGQ7XG4gIH1cbiAgaWYgKHR5cGVvZiBmaWVsZCA9PT0gXCJzdHJpbmdcIiAmJiBmaWVsZCBpbiBmaWVsZHMpIHtcbiAgICByZXR1cm4gZmllbGRzW2ZpZWxkXTtcbiAgfVxuXG4gIGNvbnN0IGNvbXBvbmVudE5hbWUgPSBDT01QT05FTlRfVFlQRVNbZ2V0U2NoZW1hVHlwZShzY2hlbWEpXTtcblxuICAvLyBJZiB0aGUgdHlwZSBpcyBub3QgZGVmaW5lZCBhbmQgdGhlIHNjaGVtYSB1c2VzICdhbnlPZicgb3IgJ29uZU9mJywgZG9uJ3RcbiAgLy8gcmVuZGVyIGEgZmllbGQgYW5kIGxldCB0aGUgTXVsdGlTY2hlbWFGaWVsZCBjb21wb25lbnQgaGFuZGxlIHRoZSBmb3JtIGRpc3BsYXlcbiAgaWYgKCFjb21wb25lbnROYW1lICYmIChzY2hlbWEuYW55T2YgfHwgc2NoZW1hLm9uZU9mKSkge1xuICAgIHJldHVybiAoKSA9PiBudWxsO1xuICB9XG5cbiAgcmV0dXJuIGNvbXBvbmVudE5hbWUgaW4gZmllbGRzXG4gICAgPyBmaWVsZHNbY29tcG9uZW50TmFtZV1cbiAgICA6ICgpID0+IHtcbiAgICAgICAgY29uc3QgeyBVbnN1cHBvcnRlZEZpZWxkIH0gPSBmaWVsZHM7XG5cbiAgICAgICAgcmV0dXJuIChcbiAgICAgICAgICA8VW5zdXBwb3J0ZWRGaWVsZFxuICAgICAgICAgICAgc2NoZW1hPXtzY2hlbWF9XG4gICAgICAgICAgICBpZFNjaGVtYT17aWRTY2hlbWF9XG4gICAgICAgICAgICByZWFzb249e2BVbmtub3duIGZpZWxkIHR5cGUgJHtzY2hlbWEudHlwZX1gfVxuICAgICAgICAgIC8+XG4gICAgICAgICk7XG4gICAgICB9O1xufVxuXG5mdW5jdGlvbiBMYWJlbChwcm9wcykge1xuICBjb25zdCB7IGxhYmVsLCByZXF1aXJlZCwgaWQgfSA9IHByb3BzO1xuICBpZiAoIWxhYmVsKSB7XG4gICAgcmV0dXJuIG51bGw7XG4gIH1cbiAgcmV0dXJuIChcbiAgICA8bGFiZWwgY2xhc3NOYW1lPVwiY29udHJvbC1sYWJlbFwiIGh0bWxGb3I9e2lkfT5cbiAgICAgIHtsYWJlbH1cbiAgICAgIHtyZXF1aXJlZCAmJiA8c3BhbiBjbGFzc05hbWU9XCJyZXF1aXJlZFwiPntSRVFVSVJFRF9GSUVMRF9TWU1CT0x9PC9zcGFuPn1cbiAgICA8L2xhYmVsPlxuICApO1xufVxuXG5mdW5jdGlvbiBMYWJlbElucHV0KHByb3BzKSB7XG4gIGNvbnN0IHsgaWQsIGxhYmVsLCBvbkNoYW5nZSB9ID0gcHJvcHM7XG4gIHJldHVybiAoXG4gICAgPGlucHV0XG4gICAgICBjbGFzc05hbWU9XCJmb3JtLWNvbnRyb2xcIlxuICAgICAgdHlwZT1cInRleHRcIlxuICAgICAgaWQ9e2lkfVxuICAgICAgb25CbHVyPXtldmVudCA9PiBvbkNoYW5nZShldmVudC50YXJnZXQudmFsdWUpfVxuICAgICAgZGVmYXVsdFZhbHVlPXtsYWJlbH1cbiAgICAvPlxuICApO1xufVxuXG5mdW5jdGlvbiBIZWxwKHByb3BzKSB7XG4gIGNvbnN0IHsgaWQsIGhlbHAgfSA9IHByb3BzO1xuICBpZiAoIWhlbHApIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuICBpZiAodHlwZW9mIGhlbHAgPT09IFwic3RyaW5nXCIpIHtcbiAgICByZXR1cm4gKFxuICAgICAgPHAgaWQ9e2lkfSBjbGFzc05hbWU9XCJoZWxwLWJsb2NrXCI+XG4gICAgICAgIHtoZWxwfVxuICAgICAgPC9wPlxuICAgICk7XG4gIH1cbiAgcmV0dXJuIChcbiAgICA8ZGl2IGlkPXtpZH0gY2xhc3NOYW1lPVwiaGVscC1ibG9ja1wiPlxuICAgICAge2hlbHB9XG4gICAgPC9kaXY+XG4gICk7XG59XG5cbmZ1bmN0aW9uIEVycm9yTGlzdChwcm9wcykge1xuICBjb25zdCB7IGVycm9ycyA9IFtdIH0gPSBwcm9wcztcbiAgaWYgKGVycm9ycy5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdj5cbiAgICAgIDx1bCBjbGFzc05hbWU9XCJlcnJvci1kZXRhaWwgYnMtY2FsbG91dCBicy1jYWxsb3V0LWluZm9cIj5cbiAgICAgICAge2Vycm9yc1xuICAgICAgICAgIC5maWx0ZXIoZWxlbSA9PiAhIWVsZW0pXG4gICAgICAgICAgLm1hcCgoZXJyb3IsIGluZGV4KSA9PiB7XG4gICAgICAgICAgICByZXR1cm4gKFxuICAgICAgICAgICAgICA8bGkgY2xhc3NOYW1lPVwidGV4dC1kYW5nZXJcIiBrZXk9e2luZGV4fT5cbiAgICAgICAgICAgICAgICB7ZXJyb3J9XG4gICAgICAgICAgICAgIDwvbGk+XG4gICAgICAgICAgICApO1xuICAgICAgICAgIH0pfVxuICAgICAgPC91bD5cbiAgICA8L2Rpdj5cbiAgKTtcbn1cbmZ1bmN0aW9uIERlZmF1bHRUZW1wbGF0ZShwcm9wcykge1xuICBjb25zdCB7XG4gICAgaWQsXG4gICAgbGFiZWwsXG4gICAgY2hpbGRyZW4sXG4gICAgZXJyb3JzLFxuICAgIGhlbHAsXG4gICAgZGVzY3JpcHRpb24sXG4gICAgaGlkZGVuLFxuICAgIHJlcXVpcmVkLFxuICAgIGRpc3BsYXlMYWJlbCxcbiAgfSA9IHByb3BzO1xuICBpZiAoaGlkZGVuKSB7XG4gICAgcmV0dXJuIDxkaXYgY2xhc3NOYW1lPVwiaGlkZGVuXCI+e2NoaWxkcmVufTwvZGl2PjtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPFdyYXBJZkFkZGl0aW9uYWwgey4uLnByb3BzfT5cbiAgICAgIHtkaXNwbGF5TGFiZWwgJiYgPExhYmVsIGxhYmVsPXtsYWJlbH0gcmVxdWlyZWQ9e3JlcXVpcmVkfSBpZD17aWR9IC8+fVxuICAgICAge2Rpc3BsYXlMYWJlbCAmJiBkZXNjcmlwdGlvbiA/IGRlc2NyaXB0aW9uIDogbnVsbH1cbiAgICAgIHtjaGlsZHJlbn1cbiAgICAgIHtlcnJvcnN9XG4gICAgICB7aGVscH1cbiAgICA8L1dyYXBJZkFkZGl0aW9uYWw+XG4gICk7XG59XG5pZiAocHJvY2Vzcy5lbnYuTk9ERV9FTlYgIT09IFwicHJvZHVjdGlvblwiKSB7XG4gIERlZmF1bHRUZW1wbGF0ZS5wcm9wVHlwZXMgPSB7XG4gICAgaWQ6IFByb3BUeXBlcy5zdHJpbmcsXG4gICAgY2xhc3NOYW1lczogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBsYWJlbDogUHJvcFR5cGVzLnN0cmluZyxcbiAgICBjaGlsZHJlbjogUHJvcFR5cGVzLm5vZGUuaXNSZXF1aXJlZCxcbiAgICBlcnJvcnM6IFByb3BUeXBlcy5lbGVtZW50LFxuICAgIHJhd0Vycm9yczogUHJvcFR5cGVzLmFycmF5T2YoUHJvcFR5cGVzLnN0cmluZyksXG4gICAgaGVscDogUHJvcFR5cGVzLmVsZW1lbnQsXG4gICAgcmF3SGVscDogUHJvcFR5cGVzLm9uZU9mVHlwZShbUHJvcFR5cGVzLnN0cmluZywgUHJvcFR5cGVzLmVsZW1lbnRdKSxcbiAgICBkZXNjcmlwdGlvbjogUHJvcFR5cGVzLmVsZW1lbnQsXG4gICAgcmF3RGVzY3JpcHRpb246IFByb3BUeXBlcy5vbmVPZlR5cGUoW1Byb3BUeXBlcy5zdHJpbmcsIFByb3BUeXBlcy5lbGVtZW50XSksXG4gICAgaGlkZGVuOiBQcm9wVHlwZXMuYm9vbCxcbiAgICByZXF1aXJlZDogUHJvcFR5cGVzLmJvb2wsXG4gICAgcmVhZG9ubHk6IFByb3BUeXBlcy5ib29sLFxuICAgIGRpc3BsYXlMYWJlbDogUHJvcFR5cGVzLmJvb2wsXG4gICAgZmllbGRzOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIGZvcm1Db250ZXh0OiBQcm9wVHlwZXMub2JqZWN0LFxuICB9O1xufVxuXG5EZWZhdWx0VGVtcGxhdGUuZGVmYXVsdFByb3BzID0ge1xuICBoaWRkZW46IGZhbHNlLFxuICByZWFkb25seTogZmFsc2UsXG4gIHJlcXVpcmVkOiBmYWxzZSxcbiAgZGlzcGxheUxhYmVsOiB0cnVlLFxufTtcblxuZnVuY3Rpb24gV3JhcElmQWRkaXRpb25hbChwcm9wcykge1xuICBjb25zdCB7XG4gICAgaWQsXG4gICAgY2xhc3NOYW1lcyxcbiAgICBkaXNhYmxlZCxcbiAgICBsYWJlbCxcbiAgICBvbktleUNoYW5nZSxcbiAgICBvbkRyb3BQcm9wZXJ0eUNsaWNrLFxuICAgIHJlYWRvbmx5LFxuICAgIHJlcXVpcmVkLFxuICAgIHNjaGVtYSxcbiAgfSA9IHByb3BzO1xuICBjb25zdCBrZXlMYWJlbCA9IGAke2xhYmVsfSBLZXlgOyAvLyBpMThuID9cbiAgY29uc3QgYWRkaXRpb25hbCA9IHNjaGVtYS5oYXNPd25Qcm9wZXJ0eShBRERJVElPTkFMX1BST1BFUlRZX0ZMQUcpO1xuXG4gIGlmICghYWRkaXRpb25hbCkge1xuICAgIHJldHVybiA8ZGl2IGNsYXNzTmFtZT17Y2xhc3NOYW1lc30+e3Byb3BzLmNoaWxkcmVufTwvZGl2PjtcbiAgfVxuXG4gIHJldHVybiAoXG4gICAgPGRpdiBjbGFzc05hbWU9e2NsYXNzTmFtZXN9PlxuICAgICAgPGRpdiBjbGFzc05hbWU9XCJyb3dcIj5cbiAgICAgICAgPGRpdiBjbGFzc05hbWU9XCJjb2wteHMtNSBmb3JtLWFkZGl0aW9uYWxcIj5cbiAgICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImZvcm0tZ3JvdXBcIj5cbiAgICAgICAgICAgIDxMYWJlbCBsYWJlbD17a2V5TGFiZWx9IHJlcXVpcmVkPXtyZXF1aXJlZH0gaWQ9e2Ake2lkfS1rZXlgfSAvPlxuICAgICAgICAgICAgPExhYmVsSW5wdXRcbiAgICAgICAgICAgICAgbGFiZWw9e2xhYmVsfVxuICAgICAgICAgICAgICByZXF1aXJlZD17cmVxdWlyZWR9XG4gICAgICAgICAgICAgIGlkPXtgJHtpZH0ta2V5YH1cbiAgICAgICAgICAgICAgb25DaGFuZ2U9e29uS2V5Q2hhbmdlfVxuICAgICAgICAgICAgLz5cbiAgICAgICAgICA8L2Rpdj5cbiAgICAgICAgPC9kaXY+XG4gICAgICAgIDxkaXYgY2xhc3NOYW1lPVwiZm9ybS1hZGRpdGlvbmFsIGZvcm0tZ3JvdXAgY29sLXhzLTVcIj5cbiAgICAgICAgICB7cHJvcHMuY2hpbGRyZW59XG4gICAgICAgIDwvZGl2PlxuICAgICAgICA8ZGl2IGNsYXNzTmFtZT1cImNvbC14cy0yXCI+XG4gICAgICAgICAgPEljb25CdXR0b25cbiAgICAgICAgICAgIHR5cGU9XCJkYW5nZXJcIlxuICAgICAgICAgICAgaWNvbj1cInJlbW92ZVwiXG4gICAgICAgICAgICBjbGFzc05hbWU9XCJhcnJheS1pdGVtLXJlbW92ZSBidG4tYmxvY2tcIlxuICAgICAgICAgICAgdGFiSW5kZXg9XCItMVwiXG4gICAgICAgICAgICBzdHlsZT17eyBib3JkZXI6IFwiMFwiIH19XG4gICAgICAgICAgICBkaXNhYmxlZD17ZGlzYWJsZWQgfHwgcmVhZG9ubHl9XG4gICAgICAgICAgICBvbkNsaWNrPXtvbkRyb3BQcm9wZXJ0eUNsaWNrKGxhYmVsKX1cbiAgICAgICAgICAvPlxuICAgICAgICA8L2Rpdj5cbiAgICAgIDwvZGl2PlxuICAgIDwvZGl2PlxuICApO1xufVxuXG5mdW5jdGlvbiBTY2hlbWFGaWVsZFJlbmRlcihwcm9wcykge1xuICBjb25zdCB7XG4gICAgdWlTY2hlbWEsXG4gICAgZm9ybURhdGEsXG4gICAgZXJyb3JTY2hlbWEsXG4gICAgaWRQcmVmaXgsXG4gICAgaWRTZXBhcmF0b3IsXG4gICAgbmFtZSxcbiAgICBvbkNoYW5nZSxcbiAgICBvbktleUNoYW5nZSxcbiAgICBvbkRyb3BQcm9wZXJ0eUNsaWNrLFxuICAgIHJlcXVpcmVkLFxuICAgIHJlZ2lzdHJ5LFxuICAgIHdhc1Byb3BlcnR5S2V5TW9kaWZpZWQgPSBmYWxzZSxcbiAgfSA9IHByb3BzO1xuICBjb25zdCB7IHJvb3RTY2hlbWEsIGZpZWxkcywgZm9ybUNvbnRleHQgfSA9IHJlZ2lzdHJ5O1xuICBjb25zdCBGaWVsZFRlbXBsYXRlID1cbiAgICB1aVNjaGVtYVtcInVpOkZpZWxkVGVtcGxhdGVcIl0gfHwgcmVnaXN0cnkuRmllbGRUZW1wbGF0ZSB8fCBEZWZhdWx0VGVtcGxhdGU7XG4gIGxldCBpZFNjaGVtYSA9IHByb3BzLmlkU2NoZW1hO1xuICBjb25zdCBzY2hlbWEgPSByZXRyaWV2ZVNjaGVtYShwcm9wcy5zY2hlbWEsIHJvb3RTY2hlbWEsIGZvcm1EYXRhKTtcbiAgaWRTY2hlbWEgPSBtZXJnZU9iamVjdHMoXG4gICAgdG9JZFNjaGVtYShzY2hlbWEsIG51bGwsIHJvb3RTY2hlbWEsIGZvcm1EYXRhLCBpZFByZWZpeCwgaWRTZXBhcmF0b3IpLFxuICAgIGlkU2NoZW1hXG4gICk7XG4gIGNvbnN0IEZpZWxkQ29tcG9uZW50ID0gZ2V0RmllbGRDb21wb25lbnQoc2NoZW1hLCB1aVNjaGVtYSwgaWRTY2hlbWEsIGZpZWxkcyk7XG4gIGNvbnN0IHsgRGVzY3JpcHRpb25GaWVsZCB9ID0gZmllbGRzO1xuICBjb25zdCBkaXNhYmxlZCA9IEJvb2xlYW4ocHJvcHMuZGlzYWJsZWQgfHwgdWlTY2hlbWFbXCJ1aTpkaXNhYmxlZFwiXSk7XG4gIGNvbnN0IHJlYWRvbmx5ID0gQm9vbGVhbihcbiAgICBwcm9wcy5yZWFkb25seSB8fFxuICAgICAgdWlTY2hlbWFbXCJ1aTpyZWFkb25seVwiXSB8fFxuICAgICAgcHJvcHMuc2NoZW1hLnJlYWRPbmx5IHx8XG4gICAgICBzY2hlbWEucmVhZE9ubHlcbiAgKTtcbiAgY29uc3QgdWlTY2hlbWFIaWRlRXJyb3IgPSB1aVNjaGVtYVtcInVpOmhpZGVFcnJvclwiXTtcbiAgLy8gU2V0IGhpZGVFcnJvciB0byB0aGUgdmFsdWUgcHJvdmlkZWQgaW4gdGhlIHVpU2NoZW1hLCBvdGhlcndpc2Ugc3RpY2sgd2l0aCB0aGUgcHJvcCB0byBwcm9wYWdhdGUgdG8gY2hpbGRyZW5cbiAgY29uc3QgaGlkZUVycm9yID1cbiAgICB1aVNjaGVtYUhpZGVFcnJvciA9PT0gdW5kZWZpbmVkXG4gICAgICA/IHByb3BzLmhpZGVFcnJvclxuICAgICAgOiBCb29sZWFuKHVpU2NoZW1hSGlkZUVycm9yKTtcbiAgY29uc3QgYXV0b2ZvY3VzID0gQm9vbGVhbihwcm9wcy5hdXRvZm9jdXMgfHwgdWlTY2hlbWFbXCJ1aTphdXRvZm9jdXNcIl0pO1xuICBpZiAoT2JqZWN0LmtleXMoc2NoZW1hKS5sZW5ndGggPT09IDApIHtcbiAgICByZXR1cm4gbnVsbDtcbiAgfVxuXG4gIGNvbnN0IGRpc3BsYXlMYWJlbCA9IGdldERpc3BsYXlMYWJlbChzY2hlbWEsIHVpU2NoZW1hLCByb290U2NoZW1hKTtcblxuICBjb25zdCB7IF9fZXJyb3JzLCAuLi5maWVsZEVycm9yU2NoZW1hIH0gPSBlcnJvclNjaGVtYTtcblxuICAvLyBTZWUgIzQzOTogdWlTY2hlbWE6IERvbid0IHBhc3MgY29uc3VtZWQgY2xhc3MgbmFtZXMgdG8gY2hpbGQgY29tcG9uZW50c1xuICBjb25zdCBmaWVsZCA9IChcbiAgICA8RmllbGRDb21wb25lbnRcbiAgICAgIHsuLi5wcm9wc31cbiAgICAgIGlkU2NoZW1hPXtpZFNjaGVtYX1cbiAgICAgIHNjaGVtYT17c2NoZW1hfVxuICAgICAgdWlTY2hlbWE9e3sgLi4udWlTY2hlbWEsIGNsYXNzTmFtZXM6IHVuZGVmaW5lZCB9fVxuICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgcmVhZG9ubHk9e3JlYWRvbmx5fVxuICAgICAgaGlkZUVycm9yPXtoaWRlRXJyb3J9XG4gICAgICBhdXRvZm9jdXM9e2F1dG9mb2N1c31cbiAgICAgIGVycm9yU2NoZW1hPXtmaWVsZEVycm9yU2NoZW1hfVxuICAgICAgZm9ybUNvbnRleHQ9e2Zvcm1Db250ZXh0fVxuICAgICAgcmF3RXJyb3JzPXtfX2Vycm9yc31cbiAgICAvPlxuICApO1xuXG4gIGNvbnN0IGlkID0gaWRTY2hlbWEuJGlkO1xuXG4gIC8vIElmIHRoaXMgc2NoZW1hIGhhcyBhIHRpdGxlIGRlZmluZWQsIGJ1dCB0aGUgdXNlciBoYXMgc2V0IGEgbmV3IGtleS9sYWJlbCwgcmV0YWluIHRoZWlyIGlucHV0LlxuICBsZXQgbGFiZWw7XG4gIGlmICh3YXNQcm9wZXJ0eUtleU1vZGlmaWVkKSB7XG4gICAgbGFiZWwgPSBuYW1lO1xuICB9IGVsc2Uge1xuICAgIGxhYmVsID0gdWlTY2hlbWFbXCJ1aTp0aXRsZVwiXSB8fCBwcm9wcy5zY2hlbWEudGl0bGUgfHwgc2NoZW1hLnRpdGxlIHx8IG5hbWU7XG4gIH1cblxuICBjb25zdCBkZXNjcmlwdGlvbiA9XG4gICAgdWlTY2hlbWFbXCJ1aTpkZXNjcmlwdGlvblwiXSB8fFxuICAgIHByb3BzLnNjaGVtYS5kZXNjcmlwdGlvbiB8fFxuICAgIHNjaGVtYS5kZXNjcmlwdGlvbjtcbiAgY29uc3QgZXJyb3JzID0gX19lcnJvcnM7XG4gIGNvbnN0IGhlbHAgPSB1aVNjaGVtYVtcInVpOmhlbHBcIl07XG4gIGNvbnN0IGhpZGRlbiA9IHVpU2NoZW1hW1widWk6d2lkZ2V0XCJdID09PSBcImhpZGRlblwiO1xuXG4gIGxldCBjbGFzc05hbWVzID0gW1wiZm9ybS1ncm91cFwiLCBcImZpZWxkXCIsIGBmaWVsZC0ke3NjaGVtYS50eXBlfWBdO1xuICBpZiAoIWhpZGVFcnJvciAmJiBlcnJvcnMgJiYgZXJyb3JzLmxlbmd0aCA+IDApIHtcbiAgICBjbGFzc05hbWVzLnB1c2goXCJmaWVsZC1lcnJvciBoYXMtZXJyb3IgaGFzLWRhbmdlclwiKTtcbiAgfVxuICBjbGFzc05hbWVzLnB1c2godWlTY2hlbWEuY2xhc3NOYW1lcyk7XG4gIGNsYXNzTmFtZXMgPSBjbGFzc05hbWVzLmpvaW4oXCIgXCIpLnRyaW0oKTtcblxuICBjb25zdCBmaWVsZFByb3BzID0ge1xuICAgIGRlc2NyaXB0aW9uOiAoXG4gICAgICA8RGVzY3JpcHRpb25GaWVsZFxuICAgICAgICBpZD17aWQgKyBcIl9fZGVzY3JpcHRpb25cIn1cbiAgICAgICAgZGVzY3JpcHRpb249e2Rlc2NyaXB0aW9ufVxuICAgICAgICBmb3JtQ29udGV4dD17Zm9ybUNvbnRleHR9XG4gICAgICAvPlxuICAgICksXG4gICAgcmF3RGVzY3JpcHRpb246IGRlc2NyaXB0aW9uLFxuICAgIGhlbHA6IDxIZWxwIGlkPXtpZCArIFwiX19oZWxwXCJ9IGhlbHA9e2hlbHB9IC8+LFxuICAgIHJhd0hlbHA6IHR5cGVvZiBoZWxwID09PSBcInN0cmluZ1wiID8gaGVscCA6IHVuZGVmaW5lZCxcbiAgICBlcnJvcnM6IGhpZGVFcnJvciA/IHVuZGVmaW5lZCA6IDxFcnJvckxpc3QgZXJyb3JzPXtlcnJvcnN9IC8+LFxuICAgIHJhd0Vycm9yczogaGlkZUVycm9yID8gdW5kZWZpbmVkIDogZXJyb3JzLFxuICAgIGlkLFxuICAgIGxhYmVsLFxuICAgIGhpZGRlbixcbiAgICBvbkNoYW5nZSxcbiAgICBvbktleUNoYW5nZSxcbiAgICBvbkRyb3BQcm9wZXJ0eUNsaWNrLFxuICAgIHJlcXVpcmVkLFxuICAgIGRpc2FibGVkLFxuICAgIHJlYWRvbmx5LFxuICAgIGhpZGVFcnJvcixcbiAgICBkaXNwbGF5TGFiZWwsXG4gICAgY2xhc3NOYW1lcyxcbiAgICBmb3JtQ29udGV4dCxcbiAgICBmb3JtRGF0YSxcbiAgICBmaWVsZHMsXG4gICAgc2NoZW1hLFxuICAgIHVpU2NoZW1hLFxuICAgIHJlZ2lzdHJ5LFxuICB9O1xuXG4gIGNvbnN0IF9BbnlPZkZpZWxkID0gcmVnaXN0cnkuZmllbGRzLkFueU9mRmllbGQ7XG4gIGNvbnN0IF9PbmVPZkZpZWxkID0gcmVnaXN0cnkuZmllbGRzLk9uZU9mRmllbGQ7XG5cbiAgcmV0dXJuIChcbiAgICA8RmllbGRUZW1wbGF0ZSB7Li4uZmllbGRQcm9wc30+XG4gICAgICA8UmVhY3QuRnJhZ21lbnQ+XG4gICAgICAgIHtmaWVsZH1cblxuICAgICAgICB7LypcbiAgICAgICAgSWYgdGhlIHNjaGVtYSBgYW55T2ZgIG9yICdvbmVPZicgY2FuIGJlIHJlbmRlcmVkIGFzIGEgc2VsZWN0IGNvbnRyb2wsIGRvbid0XG4gICAgICAgIHJlbmRlciB0aGUgc2VsZWN0aW9uIGFuZCBsZXQgYFN0cmluZ0ZpZWxkYCBjb21wb25lbnQgaGFuZGxlXG4gICAgICAgIHJlbmRlcmluZ1xuICAgICAgKi99XG4gICAgICAgIHtzY2hlbWEuYW55T2YgJiYgIWlzU2VsZWN0KHNjaGVtYSkgJiYgKFxuICAgICAgICAgIDxfQW55T2ZGaWVsZFxuICAgICAgICAgICAgZGlzYWJsZWQ9e2Rpc2FibGVkfVxuICAgICAgICAgICAgcmVhZG9ubHk9e3JlYWRvbmx5fVxuICAgICAgICAgICAgaGlkZUVycm9yPXtoaWRlRXJyb3J9XG4gICAgICAgICAgICBlcnJvclNjaGVtYT17ZXJyb3JTY2hlbWF9XG4gICAgICAgICAgICBmb3JtRGF0YT17Zm9ybURhdGF9XG4gICAgICAgICAgICBpZFByZWZpeD17aWRQcmVmaXh9XG4gICAgICAgICAgICBpZFNjaGVtYT17aWRTY2hlbWF9XG4gICAgICAgICAgICBpZFNlcGFyYXRvcj17aWRTZXBhcmF0b3J9XG4gICAgICAgICAgICBvbkJsdXI9e3Byb3BzLm9uQmx1cn1cbiAgICAgICAgICAgIG9uQ2hhbmdlPXtwcm9wcy5vbkNoYW5nZX1cbiAgICAgICAgICAgIG9uRm9jdXM9e3Byb3BzLm9uRm9jdXN9XG4gICAgICAgICAgICBvcHRpb25zPXtzY2hlbWEuYW55T2YubWFwKF9zY2hlbWEgPT5cbiAgICAgICAgICAgICAgcmV0cmlldmVTY2hlbWEoX3NjaGVtYSwgcm9vdFNjaGVtYSwgZm9ybURhdGEpXG4gICAgICAgICAgICApfVxuICAgICAgICAgICAgYmFzZVR5cGU9e3NjaGVtYS50eXBlfVxuICAgICAgICAgICAgcmVnaXN0cnk9e3JlZ2lzdHJ5fVxuICAgICAgICAgICAgc2NoZW1hPXtzY2hlbWF9XG4gICAgICAgICAgICB1aVNjaGVtYT17dWlTY2hlbWF9XG4gICAgICAgICAgLz5cbiAgICAgICAgKX1cblxuICAgICAgICB7c2NoZW1hLm9uZU9mICYmICFpc1NlbGVjdChzY2hlbWEpICYmIChcbiAgICAgICAgICA8X09uZU9mRmllbGRcbiAgICAgICAgICAgIGRpc2FibGVkPXtkaXNhYmxlZH1cbiAgICAgICAgICAgIHJlYWRvbmx5PXtyZWFkb25seX1cbiAgICAgICAgICAgIGhpZGVFcnJvcj17aGlkZUVycm9yfVxuICAgICAgICAgICAgZXJyb3JTY2hlbWE9e2Vycm9yU2NoZW1hfVxuICAgICAgICAgICAgZm9ybURhdGE9e2Zvcm1EYXRhfVxuICAgICAgICAgICAgaWRQcmVmaXg9e2lkUHJlZml4fVxuICAgICAgICAgICAgaWRTY2hlbWE9e2lkU2NoZW1hfVxuICAgICAgICAgICAgaWRTZXBhcmF0b3I9e2lkU2VwYXJhdG9yfVxuICAgICAgICAgICAgb25CbHVyPXtwcm9wcy5vbkJsdXJ9XG4gICAgICAgICAgICBvbkNoYW5nZT17cHJvcHMub25DaGFuZ2V9XG4gICAgICAgICAgICBvbkZvY3VzPXtwcm9wcy5vbkZvY3VzfVxuICAgICAgICAgICAgb3B0aW9ucz17c2NoZW1hLm9uZU9mLm1hcChfc2NoZW1hID0+XG4gICAgICAgICAgICAgIHJldHJpZXZlU2NoZW1hKF9zY2hlbWEsIHJvb3RTY2hlbWEsIGZvcm1EYXRhKVxuICAgICAgICAgICAgKX1cbiAgICAgICAgICAgIGJhc2VUeXBlPXtzY2hlbWEudHlwZX1cbiAgICAgICAgICAgIHJlZ2lzdHJ5PXtyZWdpc3RyeX1cbiAgICAgICAgICAgIHNjaGVtYT17c2NoZW1hfVxuICAgICAgICAgICAgdWlTY2hlbWE9e3VpU2NoZW1hfVxuICAgICAgICAgIC8+XG4gICAgICAgICl9XG4gICAgICA8L1JlYWN0LkZyYWdtZW50PlxuICAgIDwvRmllbGRUZW1wbGF0ZT5cbiAgKTtcbn1cblxuY2xhc3MgU2NoZW1hRmllbGQgZXh0ZW5kcyBSZWFjdC5Db21wb25lbnQge1xuICBzaG91bGRDb21wb25lbnRVcGRhdGUobmV4dFByb3BzLCBuZXh0U3RhdGUpIHtcbiAgICByZXR1cm4gIWRlZXBFcXVhbHModGhpcy5wcm9wcywgbmV4dFByb3BzKTtcbiAgfVxuXG4gIHJlbmRlcigpIHtcbiAgICByZXR1cm4gU2NoZW1hRmllbGRSZW5kZXIodGhpcy5wcm9wcyk7XG4gIH1cbn1cblxuU2NoZW1hRmllbGQuZGVmYXVsdFByb3BzID0ge1xuICB1aVNjaGVtYToge30sXG4gIGVycm9yU2NoZW1hOiB7fSxcbiAgaWRTY2hlbWE6IHt9LFxuICBkaXNhYmxlZDogZmFsc2UsXG4gIHJlYWRvbmx5OiBmYWxzZSxcbiAgYXV0b2ZvY3VzOiBmYWxzZSxcbiAgaGlkZUVycm9yOiBmYWxzZSxcbn07XG5cbmlmIChwcm9jZXNzLmVudi5OT0RFX0VOViAhPT0gXCJwcm9kdWN0aW9uXCIpIHtcbiAgU2NoZW1hRmllbGQucHJvcFR5cGVzID0ge1xuICAgIHNjaGVtYTogUHJvcFR5cGVzLm9iamVjdC5pc1JlcXVpcmVkLFxuICAgIHVpU2NoZW1hOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIGlkU2NoZW1hOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIGZvcm1EYXRhOiBQcm9wVHlwZXMuYW55LFxuICAgIGVycm9yU2NoZW1hOiBQcm9wVHlwZXMub2JqZWN0LFxuICAgIHJlZ2lzdHJ5OiB0eXBlcy5yZWdpc3RyeS5pc1JlcXVpcmVkLFxuICB9O1xufVxuXG5leHBvcnQgZGVmYXVsdCBTY2hlbWFGaWVsZDtcbiJdfQ==